FROM rust:1.51 as generator

COPY . .
RUN cargo run

FROM mongo:5.0

COPY . .
COPY --from=generator ./data ./

RUN ["chmod", "+x", "./init.sh"]
RUN ["chmod", "+x", "./mongo_setup.sh"]
CMD ./init.sh